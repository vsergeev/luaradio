<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <title>LuaRadio - AX.25 Packet Radio Receiver Example</title>
  
  <meta name="author" content="Vanya A. Sergeev" />
  <meta name="description" content="LuaRadio" />
  <link rel="canonical" href="http://luaradio.io/examples/rtlsdr-ax25.html" />
  <link rel="icon" type="image/x-icon" href="../favicon.ico" />

  <link rel="stylesheet" href="../assets/css/all.css">
  <script type="text/javascript" src="../assets/js/tocbot.min.js"></script>
  <script type="text/javascript" src="../assets/js/toc.js"></script>

  
  
</head>
<body id="top">
  <div class="container">
    <div class="row">
      <div class="three columns sidebar">
        <nav class="menu">
  <h1 class="title"><a href="..">LuaRadio</a></h1>
  <p align="center">
      <a href="https://github.com/vsergeev/luaradio"><i class="fa fa-github" aria-hidden="true"></i> GitHub</a><a href="https://github.com/vsergeev/luaradio/blob/master/ChangeLog.md"><code class="version">v0.2.0</code></a>
  </p>
  <div class="toc">
    <ul>
        <li><a href="../new-to-sdr.html">New to SDR?</a></li>
        <li><a href="../docs/">Documentation</a>
            <ul>
                <li><a href="../docs/installation.html">Installation</a></li>
                <li><a href="../docs/getting-started.html">Getting Started</a></li>
                <li><a href="../docs/creating-blocks.html">Creating Blocks</a></li>
                <li><a href="../docs/embedding-luaradio.html">Embedding LuaRadio</a></li>
                <li><a href="../docs/architecture.html">Architecture</a></li>
                <li><a href="../docs/comparison-gnuradio.html">Comparison to GNU Radio</a></li>
                <li><a href="../docs/supported-hardware.html">Supported Hardware</a></li>
            </ul>
        </li>
        <li><a href="../docs/reference-manual.html">Reference Manual</a></li>
        <li><a href="https://github.com/vsergeev/luaradio/wiki#project-roadmap">Project Roadmap</a></li>
        <li><a href="../examples/">Examples</a>
            <ul>
                <li><a href="../examples/rtlsdr-wbfm-mono.html">WBFM Mono</a></li>
                <li><a href="../examples/rtlsdr-wbfm-stereo.html">WBFM Stereo</a></li>
                <li><a href="../examples/rtlsdr-nbfm.html">NBFM</a></li>
                <li><a href="../examples/rtlsdr-ax25.html">AX.25</a></li>
                <li><a href="../examples/rtlsdr-pocsag.html">POCSAG</a></li>
                <li><a href="../examples/rtlsdr-rds.html">RDS</a></li>
                <li><a href="../examples/rtlsdr-am-envelope.html">AM (Envelope)</a></li>
                <li><a href="../examples/rtlsdr-am-synchronous.html">AM (Synchronous)</a></li>
                <li><a href="../examples/rtlsdr-ssb.html">SSB</a></li>
                <li><a href="../examples/wavfile-ssb-modulator.html">WAV SSB Modulator</a></li>
                <li><a href="../examples/iqfile-converter.html">IQ File Converter</a></li>
            </ul>
        </li>
        <li><a href="../benchmarks.html">Benchmarks</a></li>
    </ul>
  </div>
  <p align="center">
    <a style="font-size: 1.4rem;" href="mailto:vsergeev@gmail.com"><i class="fa fa-envelope-o" aria-hidden="true"></i> vsergeev@gmail.com</a>
  </p>
</nav>
<nav class="scroll-toc">
  <h1 class="title"><a data-scroll href="#top">LuaRadio</a></h1>
  <p align="center">
    <a href="https://github.com/vsergeev/luaradio"><i class="fa fa-github" aria-hidden="true"></i> GitHub</a><a href="https://github.com/vsergeev/luaradio"><code class="version">v0.2.0</code></a>
  </p>
  <div class="toc">
    <span class="page-title"><a data-scroll href="#top">AX.25 Packet Radio Receiver Example</a></span>
    <div class="js-toc">
    </div>
  </div>
</nav>

      </div>
      <div class="nine columns content">
        <h1 id="rtlsdrax25luahttpsgithubcomvsergeevluaradioblobmasterexamplesrtlsdrax25lua"><a href="https://github.com/vsergeev/luaradio/blob/master/examples/rtlsdr_ax25.lua"><code class="highlighter-rouge">rtlsdr_ax25.lua</code></a></h1>

<p>This example is an <a href="https://en.wikipedia.org/wiki/AX.25">AX.25</a> packet radio
receiver for Narrowband FM, Bell 202 AFSK modulated transmissions on the VHF
and UHF bands. It can be used to receive
<a href="https://en.wikipedia.org/wiki/Automatic_Packet_Reporting_System">APRS</a> and
other AX.25-based data transmissions. It uses the RTL-SDR as an SDR source,
writes decoded AX.25 frames in JSON to standard out, and shows two real-time
plots: the RF spectrum and the demodulated bitstream.</p>

<p>This AX.25 receiver composition is available in LuaRadio as the
<a href="../docs/reference-manual.html#ax25receiver"><code class="highlighter-rouge">AX25Receiver</code></a> block.</p>

<p align="center">
<a href="../images/screenshot-rtlsdr_ax25.png" target="_blank"><img src="../images/screenshot-rtlsdr_ax25-thumb.png" style="display: inline-block; vertical-align: middle;" /></a>
<a href="https://asciinema.org/a/3cv1a3tjkcqdtgkkwgqo37lha" target="_blank"><img src="../images/asciinema-rtlsdr_ax25-thumb.png" style="display: inline-block; vertical-align: middle;" /></a>
</p>

<h5 id="flow-graph">Flow Graph</h5>

<p align="center">
<img src="../docs/figures/flowgraph_rtlsdr_ax25.png" />
</p>

<h5 id="source">Source</h5>

<div class="highlighter-rouge"><pre class="highlight"><code><span class="kd">local</span> <span class="n">radio</span> <span class="o">=</span> <span class="nb">require</span><span class="p">(</span><span class="s1">'radio'</span><span class="p">)</span>

<span class="k">if</span> <span class="o">#</span><span class="n">arg</span> <span class="o">&lt;</span> <span class="mi">1</span> <span class="k">then</span>
    <span class="nb">io.stderr</span><span class="p">:</span><span class="n">write</span><span class="p">(</span><span class="s2">"Usage: "</span> <span class="o">..</span> <span class="n">arg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">..</span> <span class="s2">" &lt;frequency&gt;\n"</span><span class="p">)</span>
    <span class="nb">os.exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">end</span>

<span class="kd">local</span> <span class="n">frequency</span> <span class="o">=</span> <span class="nb">tonumber</span><span class="p">(</span><span class="n">arg</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="kd">local</span> <span class="n">tune_offset</span> <span class="o">=</span> <span class="o">-</span><span class="mf">100e3</span>
<span class="kd">local</span> <span class="n">baudrate</span> <span class="o">=</span> <span class="mi">1200</span>

<span class="c1">-- Blocks</span>
<span class="kd">local</span> <span class="n">source</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">RtlSdrSource</span><span class="p">(</span><span class="n">frequency</span> <span class="o">+</span> <span class="n">tune_offset</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">tuner</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">TunerBlock</span><span class="p">(</span><span class="n">tune_offset</span><span class="p">,</span> <span class="mf">12e3</span><span class="p">,</span> <span class="mi">80</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">nbfm_demod</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">NBFMDemodulator</span><span class="p">(</span><span class="mf">3e3</span><span class="p">,</span> <span class="mf">3e3</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">hilbert</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">HilbertTransformBlock</span><span class="p">(</span><span class="mi">129</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">translator</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">FrequencyTranslatorBlock</span><span class="p">(</span><span class="o">-</span><span class="mi">1700</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">afsk_filter</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">LowpassFilterBlock</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="mi">750</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">afsk_demod</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">FrequencyDiscriminatorBlock</span><span class="p">(</span><span class="mi">1</span><span class="p">.</span><span class="mi">25</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">data_filter</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">LowpassFilterBlock</span><span class="p">(</span><span class="mi">128</span><span class="p">,</span> <span class="n">baudrate</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">clock_recoverer</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">ZeroCrossingClockRecoveryBlock</span><span class="p">(</span><span class="n">baudrate</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">sampler</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">SamplerBlock</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">bit_slicer</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">SlicerBlock</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">bit_decoder</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">DifferentialDecoderBlock</span><span class="p">(</span><span class="kc">true</span><span class="p">)</span>
<span class="kd">local</span> <span class="n">framer</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">AX25FramerBlock</span><span class="p">()</span>
<span class="kd">local</span> <span class="n">sink</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">JSONSink</span><span class="p">()</span>

<span class="c1">-- Plotting sinks</span>
<span class="kd">local</span> <span class="n">plot1</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">GnuplotSpectrumSink</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="s1">'RF Spectrum'</span><span class="p">,</span> <span class="p">{</span><span class="n">yrange</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">120</span><span class="p">,</span> <span class="o">-</span><span class="mi">60</span><span class="p">}})</span>
<span class="kd">local</span> <span class="n">plot2</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">GnuplotPlotSink</span><span class="p">(</span><span class="mi">2048</span><span class="p">,</span> <span class="s1">'Demodulated Bitstream'</span><span class="p">,</span> <span class="p">{</span><span class="n">yrange</span> <span class="o">=</span> <span class="p">{</span><span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">,</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="p">}})</span>

<span class="c1">-- Connections</span>
<span class="kd">local</span> <span class="n">top</span> <span class="o">=</span> <span class="n">radio</span><span class="p">.</span><span class="n">CompositeBlock</span><span class="p">()</span>
<span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">source</span><span class="p">,</span> <span class="n">tuner</span><span class="p">,</span> <span class="n">nbfm_demod</span><span class="p">)</span>
<span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">nbfm_demod</span><span class="p">,</span> <span class="n">hilbert</span><span class="p">,</span> <span class="n">translator</span><span class="p">,</span> <span class="n">afsk_filter</span><span class="p">,</span> <span class="n">afsk_demod</span><span class="p">,</span> <span class="n">data_filter</span><span class="p">,</span> <span class="n">clock_recoverer</span><span class="p">)</span>
<span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">data_filter</span><span class="p">,</span> <span class="s1">'out'</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="s1">'data'</span><span class="p">)</span>
<span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">clock_recoverer</span><span class="p">,</span> <span class="s1">'out'</span><span class="p">,</span> <span class="n">sampler</span><span class="p">,</span> <span class="s1">'clock'</span><span class="p">)</span>
<span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">sampler</span><span class="p">,</span> <span class="n">bit_slicer</span><span class="p">,</span> <span class="n">bit_decoder</span><span class="p">,</span> <span class="n">framer</span><span class="p">,</span> <span class="n">sink</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">os.getenv</span><span class="p">(</span><span class="s1">'DISPLAY'</span><span class="p">)</span> <span class="k">then</span>
    <span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">tuner</span><span class="p">,</span> <span class="n">plot1</span><span class="p">)</span>
    <span class="n">top</span><span class="p">:</span><span class="n">connect</span><span class="p">(</span><span class="n">data_filter</span><span class="p">,</span> <span class="n">plot2</span><span class="p">)</span>
<span class="k">end</span>

<span class="n">top</span><span class="p">:</span><span class="n">run</span><span class="p">()</span>
</code></pre>
</div>

<h5 id="usage">Usage</h5>

<div class="highlighter-rouge"><pre class="highlight"><code>Usage: examples/rtlsdr_ax25.lua &lt;frequency&gt;
</code></pre>
</div>

<p>Running this example in a headless environment will inhibit plotting.</p>

<h5 id="usage-example">Usage Example</h5>

<p>Receive APRS on 144.390 MHz, the North American VHF APRS frequency:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>$ ./luaradio examples/rtlsdr_ax25.lua 144.390e6
{"payload":"@030151z3845.28N/12035.52W_000/000g000t054r000p000P000h70b10136/ {UIV32N}\r","control":3,"addresses":[{"ssid":48,"callsign":"APU25N"},{"ssid":112,"callsign":"K6GER "},{"ssid":112,"callsign":"WARD  "},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE2 "}],"pid":240}
{"payload":"`2-1l 5k/'\"3r}GTARC 146.805 &amp; 406.600 both (-) PL 100|)2%n']|!w?;!|3","control":3,"addresses":[{"ssid":48,"callsign":"S8QXXW"},{"ssid":57,"callsign":"KJ6PCW"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "},{"ssid":49,"callsign":"WIDE2 "}],"pid":240}
{"payload":"`2-1l 5k/'\"3r}GTARC 146.805 &amp; 406.600 both (-) PL 100|)2%n']|!w?;!|3","control":3,"addresses":[{"ssid":48,"callsign":"S8QXXW"},{"ssid":57,"callsign":"KJ6PCW"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "},{"ssid":112,"callsign":"BKELEY"},{"ssid":112,"callsign":"WIDE2 "}],"pid":240}
{"payload":"@094656h3754.16NI12216.92W&amp;(Time 0:00:00)PHG3340/Kensington, CA (I-GATE) */A=000404","control":3,"addresses":[{"ssid":112,"callsign":"APWW10"},{"ssid":53,"callsign":"KC6SSM"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "},{"ssid":49,"callsign":"WIDE2 "}],"pid":240}
{"payload":"!3956.16N/12138.86W# 13.6V 62F ","control":3,"addresses":[{"ssid":112,"callsign":"APOT30"},{"ssid":115,"callsign":"W6SCR "},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "}],"pid":240}
{"payload":"`1N8l#K&gt;/`\"4{}443.575MHz T110 +500_%\r","control":3,"addresses":[{"ssid":48,"callsign":"SWRSYY"},{"ssid":121,"callsign":"KE6STH"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "},{"ssid":49,"callsign":"WIDE2 "}],"pid":240}
{"payload":"`1N8l#K&gt;/`\"4{}443.575MHz T110 +500_%\r","control":3,"addresses":[{"ssid":48,"callsign":"SWRSYY"},{"ssid":121,"callsign":"KE6STH"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE1 "},{"ssid":112,"callsign":"BKELEY"},{"ssid":112,"callsign":"WIDE2 "}],"pid":240}
{"payload":"@270947z3715.26N/12153.30W#Digi &amp; Igate / ron@k6rpt.com","control":3,"addresses":[{"ssid":48,"callsign":"APMI06"},{"ssid":48,"callsign":"K6RPT "},{"ssid":115,"callsign":"N6ZX  "},{"ssid":49,"callsign":"WIDE2 "}],"pid":240}
{"payload":"@270947z3715.26N/12153.30W#Digi &amp; Igate / ron@k6rpt.com","control":3,"addresses":[{"ssid":48,"callsign":"APMI06"},{"ssid":48,"callsign":"K6RPT "},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"BKELEY"},{"ssid":112,"callsign":"WIDE2 "}],"pid":240}
{"payload":"!4001.07N/12122.89W# 12.8V 44F K6FHL Highlakes Fillin W1","control":3,"addresses":[{"ssid":112,"callsign":"APOT30"},{"ssid":112,"callsign":"HILAKE"},{"ssid":115,"callsign":"N6ZX  "},{"ssid":112,"callsign":"WIDE2 "}],"pid":240}
...
</code></pre>
</div>


        <div class="footer">
          <div class="disclaimer">
  <p>
    Â© Vanya A. Sergeev, 2016 &mdash; built with <a href="http://jekyllrb.com/">Jekyll</a>, theme based on <a href="https://github.com/swanson/lagom">Lagom</a>
  </p>
</div>

        </div>
      </div>
    </div>
  </div>
</body>
</html>
